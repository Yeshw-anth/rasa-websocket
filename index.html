<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Chat with Rasa Bot</title>
  <style>
    /* Optional: Page-level styling */
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
      background: #f5f5f5;
    }
    h1 {
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Welcome to Our Chatbot</h1>
  <p>Click the chat widget at the bottom-right corner to start chatting.</p>
  
  <!-- The Rasa Webchat widget will be rendered here -->
  <div id="webchat"></div>
  
  <!-- Load and initialize the Rasa Webchat widget -->
  <script>
    !(function () {
      let e = document.createElement("script"),
        t = document.head || document.getElementsByTagName("head")[0];
      (e.src = "https://cdn.jsdelivr.net/npm/rasa-webchat@1.0.1/lib/index.js"),
        (e.async = !0),
        (e.onload = () => {
          window.WebChat.default(
            {
              initPayload: "/greet",
              customData: { language: "en" },
              socketUrl: "https://b72d-14-194-40-218.ngrok-free.app",
              storage: "session", // Resets chat on refresh
            },
            null
          );
        }),
        t.insertBefore(e, t.firstChild);
    })();

    // Auto-refresh after 5 minutes of inactivity
    let idleTime = 0;
    setInterval(function() {
      idleTime++;
      if (idleTime > 5) {  // 5 minutes of inactivity
        localStorage.clear();  // Clears chat history
        location.reload();  // Refresh page
      }
    }, 60000);  // Runs every minute

    // Reset idle time on user activity
    document.onmousemove = document.onkeypress = function() {
      idleTime = 0;
    };
  </script>
</body>
</html>
